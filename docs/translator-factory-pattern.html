<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>Translator-Factory-Pattern</title>

    <link rel="stylesheet" href="https://rajasgs.github.io/mlnotes/theme/css/normalize.css" />
    <link rel="stylesheet" href="https://rajasgs.github.io/mlnotes/theme/css/foundation.min.css" />
    <link rel="stylesheet" href="https://rajasgs.github.io/mlnotes/theme/css/style.css" />
    <link rel="stylesheet" href="https://rajasgs.github.io/mlnotes/theme/css/pygments.css" />	
    <script src="https://rajasgs.github.io/mlnotes/theme/js/modernizr.js"></script>
</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href="https://rajasgs.github.io/mlnotes">ML Notes</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">

    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
<article>
    <header>
        <h3 class="article-title"><a href="https://rajasgs.github.io/mlnotes/translator-factory-pattern.html" rel="bookmark"
        title="Permalink to Translator-Factory-Pattern">Translator-Factory-Pattern</a></h3>
    </header>

<h6 class="subheader" title="2025-01-04T00:00:00-05:00">Sat 04 January 2025
</h6>


    <div class="highlight"><pre><span></span><code>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pyutil</span> <span class="k">as</span> <span class="nn">pyu</span>
<span class="n">pyu</span><span class="o">.</span><span class="n">get_local_pyinfo</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="s1">&#39;conda env: ml311; pyv: 3.11.10 (main, Oct  3 2024, 07:29:13) </span><span class="cp">[</span><span class="nx">GCC</span><span class="w"> </span><span class="mf">11.2.0</span><span class="cp">]</span><span class="s1">&#39;</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">pyu</span><span class="o">.</span><span class="n">ps2</span><span class="p">(</span><span class="s2">&quot;haystack-ai ollama-haystack python-dotenv&quot;</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>haystack-ai==2.8.0
ollama-haystack is not installed in the current environment.
python-dotenv==0.21.0
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">translate</span> <span class="kn">import</span> <span class="n">Translator</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForSeq2SeqLM</span><span class="p">,</span> <span class="n">AutoTokenizer</span>
<span class="kn">from</span> <span class="nn">deep_translator</span> <span class="kn">import</span> <span class="n">GoogleTranslator</span>
<span class="kn">import</span> <span class="nn">argostranslate.package</span>
<span class="kn">import</span> <span class="nn">argostranslate.translate</span>

<span class="c1"># Step 1: Define an abstract base class (interface)</span>
<span class="k">class</span> <span class="nc">CustomTranslator</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Step 2: Create concrete implementations of the Shape interface</span>
<span class="k">class</span> <span class="nc">CTranslatorVanilla</span><span class="p">(</span><span class="n">CustomTranslator</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language_code</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vanilla init called&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">translator</span> <span class="o">=</span> <span class="n">Translator</span><span class="p">(</span><span class="n">to_lang</span><span class="o">=</span><span class="n">language_code</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CTranslatorLLM</span><span class="p">(</span><span class="n">CustomTranslator</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language_code</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;llm init called&quot;</span><span class="p">)</span>
        <span class="n">model_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Helsinki-NLP/opus-mt-en-</span><span class="si">{</span><span class="n">language_code</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">translator</span> <span class="o">=</span> <span class="n">Translator</span><span class="p">(</span><span class="n">to_lang</span><span class="o">=</span><span class="n">language_code</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForSeq2SeqLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>

        <span class="c1"># Tokenize the input</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Generate translation</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">num_beams</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CTranslatorDeepT</span><span class="p">(</span><span class="n">CustomTranslator</span><span class="p">):</span>

    <span class="n">_instance</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language_code</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;initialized&quot;</span><span class="p">):</span>  <span class="c1"># To prevent reinitialization</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DeepT init called&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span> <span class="o">=</span> <span class="n">GoogleTranslator</span><span class="p">(</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">language_code</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">current_language_code</span> <span class="o">=</span> <span class="s2">&quot;fi&quot;</span>

<span class="c1"># Step 3: Create a Factory class to generate objects</span>
<span class="k">class</span> <span class="nc">CustomTranslatorFactory</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_custom_translator</span><span class="p">(</span><span class="n">translator_type</span><span class="p">,</span> <span class="n">language_code</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">translator_type</span> <span class="o">==</span> <span class="s2">&quot;vanilla&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CTranslatorVanilla</span><span class="p">(</span><span class="n">language_code</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">translator_type</span> <span class="o">==</span> <span class="s2">&quot;llm&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CTranslatorLLM</span><span class="p">(</span><span class="n">language_code</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">translator_type</span> <span class="o">==</span> <span class="s2">&quot;deept&quot;</span><span class="p">:</span>
            <span class="n">ctranslator</span> <span class="o">=</span> <span class="n">CTranslatorDeepT</span><span class="p">(</span><span class="n">language_code</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">translator_type</span> <span class="o">==</span> <span class="s2">&quot;argo&quot;</span><span class="p">:</span>
            <span class="n">ctranslator</span> <span class="o">=</span> <span class="n">CTranslatorArgo</span><span class="p">(</span><span class="n">language_code</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown translator type: </span><span class="si">{</span><span class="n">translator_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ctranslator</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CTranslatorArgo</span><span class="p">(</span><span class="n">CustomTranslator</span><span class="p">):</span>

    <span class="n">_instance</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language_code</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;initialized&quot;</span><span class="p">):</span>  <span class="c1"># To prevent reinitialization</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Argo init called&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">language_code</span> <span class="o">=</span> <span class="n">language_code</span>

            <span class="n">argostranslate</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">update_package_index</span><span class="p">()</span>
            <span class="n">available_packages</span> <span class="o">=</span> <span class="n">argostranslate</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">get_available_packages</span><span class="p">()</span>

            <span class="n">package_to_install</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">from_code</span> <span class="o">==</span> <span class="s2">&quot;en&quot;</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">to_code</span> <span class="o">==</span> <span class="n">language_code</span><span class="p">,</span>
                    <span class="n">available_packages</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">argostranslate</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">install_from_path</span><span class="p">(</span><span class="n">package_to_install</span><span class="o">.</span><span class="n">download</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">argostranslate</span><span class="o">.</span><span class="n">translate</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">language_code</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Client Code</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># Use the factory to create shapes</span>
    <span class="n">ctranslator_factory</span> <span class="o">=</span> <span class="n">CustomTranslatorFactory</span><span class="p">()</span>

    <span class="n">current_language_code</span> <span class="o">=</span> <span class="s2">&quot;fi&quot;</span>

    <span class="n">shape1</span> <span class="o">=</span> <span class="n">ctranslator_factory</span><span class="o">.</span><span class="n">get_custom_translator</span><span class="p">(</span><span class="s2">&quot;deept&quot;</span><span class="p">,</span> <span class="n">current_language_code</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">shape1</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">&quot;how are you?&quot;</span><span class="p">))</span>

    <span class="n">shape2</span> <span class="o">=</span> <span class="n">ctranslator_factory</span><span class="o">.</span><span class="n">get_custom_translator</span><span class="p">(</span><span class="s2">&quot;llm&quot;</span><span class="p">,</span> <span class="n">current_language_code</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">shape2</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">&quot;how are you?&quot;</span><span class="p">))</span>

    <span class="n">shape2</span> <span class="o">=</span> <span class="n">ctranslator_factory</span><span class="o">.</span><span class="n">get_custom_translator</span><span class="p">(</span><span class="s2">&quot;argo&quot;</span><span class="p">,</span> <span class="n">current_language_code</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">shape2</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">&quot;where are you?&quot;</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">DeepT</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">called</span>
<span class="n">kuinka</span><span class="w"> </span><span class="n">voit</span><span class="err">?</span>
<span class="n">llm</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">called</span>
<span class="n">Mitä</span><span class="w"> </span><span class="n">kuuluu</span><span class="err">?</span>
<span class="n">Argo</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">called</span>
<span class="n">Missä</span><span class="w"> </span><span class="n">olet</span><span class="err">?</span>


<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rajaraman</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">ml311</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">torch</span><span class="o">/</span><span class="n">cuda</span><span class="o">/</span><span class="n">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">129</span><span class="p">:</span><span class="w"> </span><span class="n">UserWarning</span><span class="p">:</span><span class="w"> </span><span class="n">CUDA</span><span class="w"> </span><span class="n">initialization</span><span class="p">:</span><span class="w"> </span><span class="n">CUDA</span><span class="w"> </span><span class="n">unknown</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">incorrectly</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">changing</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">CUDA_VISIBLE_DEVICES</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="w"> </span><span class="n">Setting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">zero</span><span class="o">.</span><span class="w"> </span><span class="p">(</span><span class="n">Triggered</span><span class="w"> </span><span class="n">internally</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">../</span><span class="n">c10</span><span class="o">/</span><span class="n">cuda</span><span class="o">/</span><span class="n">CUDAFunctions</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mf">108.</span><span class="p">)</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">torch</span><span class="o">.</span><span class="n">_C</span><span class="o">.</span><span class="n">_cuda_getDeviceCount</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rajaraman</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">ml311</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">stanza</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">tokenize</span><span class="o">/</span><span class="n">trainer</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">85</span><span class="p">:</span><span class="w"> </span><span class="n">FutureWarning</span><span class="p">:</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="err">`</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="err">`</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">weights_only</span><span class="o">=</span><span class="n">False</span><span class="err">`</span><span class="w"> </span><span class="p">(</span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="p">),</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">pickle</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="n">implicitly</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">construct</span><span class="w"> </span><span class="n">malicious</span><span class="w"> </span><span class="n">pickle</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">arbitrary</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">unpickling</span><span class="w"> </span><span class="p">(</span><span class="n">See</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pytorch</span><span class="o">/</span><span class="n">pytorch</span><span class="o">/</span><span class="n">blob</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">SECURITY</span><span class="o">.</span><span class="n">md</span><span class="c1">#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don&#39;t have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.</span>
<span class="w">  </span><span class="n">checkpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="n">storage</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="p">:</span><span class="w"> </span><span class="n">storage</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>

<hr>
<p><strong>Score: 15</strong></p>
<p class="subheader">Category: <a href="https://rajasgs.github.io/mlnotes/category/mythraki.html">mythraki</a>

</p>




</article>
    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="https://rajasgs.github.io/mlnotes/archives.html">Archives</a>
            <li><a href="https://rajasgs.github.io/mlnotes/tags.html">Tags</a>
        </ul>

		
        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="https://rajasgs.github.io/mlnotes/category/arima.html">arima</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/array.html">array</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/assignments.html">assignments</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/async.html">async</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/barchart.html">barchart</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/basics.html">basics</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/bokeh.html">bokeh</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/collab-filtering.html">collab-filtering</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/cricket.html">cricket</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/data-wrangling.html">data-wrangling</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/deepchecks.html">deepchecks</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/duckdb.html">duckdb</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/encoding.html">encoding</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/error-analyzer.html">error-analyzer</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/evidentlyai.html">evidentlyai</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/file-utils.html">file-utils</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/game20241121.html">game20241121</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/gensim-samples.html">gensim-samples</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/geopandas.html">geopandas</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/gliner.html">gliner</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/haystack.html">haystack</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/hyperparam-tuning.html">hyperparam-tuning</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/image-analysis.html">image-analysis</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/image-work.html">image-work</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/ip.html">ip</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/kaggle.html">kaggle</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/langchain.html">langchain</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/leetcode.html">leetcode</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/mlbasics.html">mlbasics</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/mythraki.html">mythraki</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/numba.html">numba</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/numpy.html">numpy</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/one.html">one</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/pandas.html">pandas</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/pdfbot.html">pdfbot</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/plot.html">plot</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/plot-compare.html">plot-compare</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/plotly.html">plotly</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/pydotplus.html">pydotplus</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/regex.html">regex</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/resume-analysis.html">resume-analysis</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/scipy.html">scipy</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/seaborn.html">seaborn</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/sentiment.html">sentiment</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/sklearn.html">sklearn</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/spacy.html">spacy</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/sqlalchemy.html">sqlalchemy</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/statsmodel.html">statsmodel</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/stockmarket.html">stockmarket</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/sys.html">sys</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/sysargs.html">sysargs</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/tensorflow-work.html">tensorflow-work</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/textprocessing.html">textprocessing</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/tips.html">tips</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/trends.html">trends</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/webreader.html">webreader</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/xgboost.html">xgboost</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/yellowbrick.html">yellowbrick</a></li>
            <li><a href="https://rajasgs.github.io/mlnotes/category/zzemp.html">zzemp</a></li>
   
        </ul>

		
        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="https://github.com/<yourusername>/">GitHub</a></li>
            <li><a href="<linkedin handle>">LinkedIn</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
              <!--                  <p>ML Notes by Raja CSP RAman</p> -->
            </div>
            </div>
    </div>
</footer>
</body>
</html>